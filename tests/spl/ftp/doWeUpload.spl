include "../../../lib/console.spl";
include "../array/string.spl";

procedure doWeUpload()
  returns (res: Int)
  ensures (res == -1) || (res == 1) || (res == 0)
{

  var updown := new Array<Byte>(2);

  var text := new Array<Byte>(28);
  text := "upload (u) or download (d):";
  var written := gputs(text);
  var textLen := strlen(text);
  free(text);
  if (written != textLen) {
    free(updown);
    return -1;
  } else {
    var numChars := ggets(updown);

    if (numChars == 1) {
      updown[1] := int2byte(0);
      var uChar := new Array<Byte>(2);
      uChar := "u";
    
      if (strcmp(uChar, updown) == 0) {
        free(uChar);
	free(updown);
	return 1;
      } else {
	free(uChar);
	free(updown);
	return 0;
      }
    } else {
      free(updown);
      return -1;
    }
  }
}
